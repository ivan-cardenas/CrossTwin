<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href=" https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css " rel="stylesheet">
    <link rel="stylesheet" href="{% static '/css/theme.css' %}">

    {% block extra_css %}{% endblock extra_css %}

    {% block extra_js %}{% endblock extra_js %}

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    
    <script>
class LoadingManager {
    constructor() {
        this.overlay = document.getElementById('loadingOverlay');
        this.activeRequests = 0;
        this.setupFetchInterceptor();
    }

    show(message = 'Loading...') {
        this.activeRequests++;
        if (this.overlay) {
            const textEl = this.overlay.querySelector('.loading-text');
            if (textEl) textEl.textContent = message;
            this.overlay.classList.remove('hidden');
        }
    }

    hide() {
        this.activeRequests = Math.max(0, this.activeRequests - 1);
        if (this.activeRequests === 0 && this.overlay) {
            this.overlay.classList.add('hidden');
        }
    }

    setupFetchInterceptor() {
        // Intercept all fetch requests automatically
        const originalFetch = window.fetch;
        window.fetch = async (...args) => {
            this.show();
            try {
                const response = await originalFetch(...args);
                return response;
            } finally {
                this.hide();
            }
        };

        // Intercept XMLHttpRequest for older AJAX calls
        const originalOpen = XMLHttpRequest.prototype.open;
        const originalSend = XMLHttpRequest.prototype.send;
        const self = this;

        XMLHttpRequest.prototype.open = function(...args) {
            this._loadingManager = self;
            return originalOpen.apply(this, args);
        };

        XMLHttpRequest.prototype.send = function(...args) {
            if (this._loadingManager) {
                this._loadingManager.show();
                this.addEventListener('loadend', () => {
                    this._loadingManager.hide();
                });
            }
            return originalSend.apply(this, args);
        };
    }

    // Manual control methods
    forceShow(message) {
        this.show(message);
    }

    forceHide() {
        this.activeRequests = 0;
        this.hide();
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', () => {
    window.loadingManager = new LoadingManager();
});

// Example usage for manual control:
// window.loadingManager.forceShow('Importing data...');
// window.loadingManager.forceHide();
</script>


    <title>Digital Twin Cross Sector Planning</title>
</head>
<body class="min-h-screen overflow-x-hidden">
    <div id="loadingOverlay" class="loading-overlay hidden">
    <div class="loading-spinner">
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="loading-text">Loading...</div>
    </div>
</div>

    <div class="gradient-orb orb-top-left"></div>
    <div class="gradient-orb secondary orb-bottom-right"></div>

    <div class="relative min-h-screen flex flex-col z-10">
        <header class="glass sticky top-0 backdrop-blur-xl">
            <div class="container mx-auto px-6 py-4 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="h-10 w-10 rounded-xl bg-gradient-to-br from-cyan-400 via-sky-500 to-indigo-600 shadow-lg shadow-cyan-900/30"></div>
                    <div>
                        <p class="text-[11px] uppercase tracking-[0.28em] text-cyan-200/80">Digital Twin</p>
                        <h1 class="text-lg md:text-xl font-semibold text-slate-50">Cross Sector Planning</h1>
                    </div>
                </div>
                <div class="hidden md:flex items-center gap-3 text-slate-300">
                    <span class="px-3 py-1 text-sm rounded-full bg-white/5 border border-white/10">Live Prototype</span>
                    <span class="text-xs text-slate-400">v0.1</span>
                </div>
            </div>
        </header>

        <main class="flex-1">
            <section class="container mx-auto px-6 pt-12 pb-8 md:pb-12">
                <div class="max-w-8xl space-y-3">
                    <p class="text-[11px] uppercase tracking-[0.32em] text-cyan-100/75">Welcome to the Cross-Sector Digital Twin</p>
                    <p class="text-2xl md:text-3xl font-semibold text-slate-50 leading-tight">Simulate scenarios and make informed planning decisions</p>
                    <p class="text-base text-slate-300">Build, iterate, and validate your digital twins inside a focused, unified workspace.</p>
                </div>
            </section>

            <section class="max-w-8xl mx-auto px-6 pb-16 h-[calc(100vh-4rem)] min-h-0">
                <div class="glass rounded-2xl p-6 md:p-8 fade-in h-full min-h-0">
                    {% block content %}
                    
                    {% endblock content %}
                </div>
            </section>
        </main>

        <footer class="container mx-auto px-6 pb-10 text-sm text-slate-400 flex flex-col md:flex-row md:items-center md:justify-between gap-3">
            <div class="flex items-center gap-3">
                <span class="h-px w-12 bg-white/10"></span>
                <span>Built for collaborative scenario planning.</span>
            </div>
            <div class="flex items-center gap-4 text-slate-500">
                <span>Need help? Share feedback.</span>
            </div>
        </footer>
    </div>
</body>
</html>
